{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <link href="static/css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    <link href="static/css/site.css" type="text/css" rel="stylesheet" media="screen,projection"/>


    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-analytics.js"></script>
    <script src="static/js/uikit.min.js"></script>
    <script src="static/js/uikit-icons.min.js"></script>

    <script>
        //firebaseConfig: Can be found in firebase console > project settings
        var firebaseConfig = {
          apiKey: "AIzaSyDd-qHOt59RSvm69sh35mezJVGjsJ1F24c",
          authDomain: "blood-ed205.firebaseapp.com",
          databaseURL: "https://blood-ed205-default-rtdb.firebaseio.com",
          projectId: "blood-ed205",
          storageBucket: "blood-ed205.appspot.com",
          messagingSenderId: "855502396366",
          appId: "1:855502396366:web:805e45de37c01d928d299f",
          measurementId: "G-JFKEMRMBZM"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
      
        const messaging = firebase.messaging();
        console.log(messaging.getToken())
        //vapidKey : Can be found in firebase console > project settings > cloud messaging > web push certificaes (key pair)
        messaging.getToken({ vapidKey: 'BFPAwJKzSUleiU4XsCXOGncLfBw9TwadCLB28n4i-hhVU3CC6stOvDQEkoDOyx3SzAkm4f4iRbeL41fcuRK7YmM' }).then((currentToken) => {
        if (currentToken) {
          
          console.log(currentToken)
        } else {
          console.log('No registration token available. Request permission to generate one.');
       
        }
      }).catch((err) => {
        console.log('An error occurred while retrieving token. ', err);
      });
      
      
        messaging
         .requestPermission()
         .then(function () {
           console.log("Notification permission granted.");
           return messaging.getToken()
         })
         .catch(function (err) {
         console.log("Unable to get permission to notify.", err);
       });
      
      
        messaging.onMessage((payload) => {
        console.log('Message received. ', payload);
       
      });
      
      
      
      </script>

    <title>Find My Blood</title>
</head>
<body>
    
    <div class="uk-position-center" uk-spinner="ratio: 3" style="color:white;" id="loader" ></div>

    <div class="uk-card uk-card-default uk-card-body uk-width-5-6 uk-align-center uk-text-center round uk-margin-remove-top" id="main" hidden>
        <div class="uk-grid">
            <div class="uk-width-2-3">
                <h2 class="uk-text-left">Find My Blood <i class="fas fa-tint" style="color: #951A23;"></i></h2>
                <p class="uk-text-left">Find a match to save a life.</p><br>
                <img src="static/images/stock.jpeg">

            </div>
            <div class="uk-width-1-3 uk-padding">
            <h2>Welcome!</h2>
            
        
                <p>
                    <form action="/signin" method="POST">
                        
                        <div class="uk-margin">
                            <div class="uk-inline">
                                <span class="uk-form-icon" uk-icon="icon: user"></span>
                                <input class="uk-input uk-text-center uk-form-width-large round" type="email" name="email" placeholder="Email" required>
                            </div>
                        </div>
                        <div class="uk-margin">
                            <div class="uk-inline">
                                <span class="uk-form-icon" uk-icon="icon: lock"></span>
                                <input class="uk-input uk-text-center uk-form-width-large round" type="password" name="password" placeholder="Password"/ required>
                                
                            </div>
                        </div>
                        <br>
                        <input class=" uk-button uk-button-primary uk-button round uk-width-1-1" type="submit" value="Sign In"/>

                    </form>
                </p>
                <p><b>OR</b></p>
                <p>
                    <!-- <button class="uk-button uk-button-primary uk-button round uk-width-1-1" onclick="window.location='/signup';">Sign Up</button> -->
                    <button class="uk-button uk-button-default uk-button round uk-width-1-1" uk-toggle="target: #my-id" type="button">Sign Up</button>
                    <div id="my-id"  uk-modal>
                        <div class="uk-modal-dialog uk-modal-body uk-text-center round uk-margin-large-top">
                            
                                <button class="uk-modal-close-default" type="button" uk-close></button>
                            
                            <h2 class="uk-modal-title">Please Choose</h2>
                            <p> How would you like to signup your account as ?</p><br>
                            <form action="/signup" method="POST">
                                <input type="hidden" id="type" name="type" value="rec">
                                <input class=" uk-button uk-button-primary uk-button round uk-width-1-2" type="submit" value="Reciever"/>
                            </form>
                            <p><b>OR</b></p>
                            <form action="/signup" method="POST">
                                <input type="hidden" id="type" name="type" value="donor">
                                <input class=" uk-button uk-button-primary uk-button round uk-width-1-2" type="submit" value="Donor"/>
                            </form>
                            
                        </div>
                    </div>
                </p>
                
            </div>
        </div>
        

    </div>

    {% if signuptoken %}
        <script>UIkit.notification("<span uk-icon='icon: check'></span> Sign Up Succesful.");</script>

    {% endif %}

    {% if error %}
        <script>UIkit.notification("<span uk-icon='icon: close'></span> Email or Password Incorrect");</script>

    {% endif %}

    {% if signupfailure %}
        <script>UIkit.notification("<span uk-icon='icon: close'></span> Not eligible to donate. Please try again after 3 months.");</script>

    {% endif %}



    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="{% static "js/init.js" %}"></script>s
    <script src="{% static "js/script.js" %}"></script>
    <script src="https://kit.fontawesome.com/e0a08b5c11.js" crossorigin="anonymous"></script>
</body>
</html>